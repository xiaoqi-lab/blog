---
import { Image } from 'astro:assets';
import type { CollectionEntry } from 'astro:content';
import BaseLayout from './BaseLayout.astro';
import BaseHead from '../components/BaseHead.astro';
import { getTranslation } from '../i18n/index';

type Props = CollectionEntry<'blog'>['data'];

const { title, description, pubDate, updatedDate, heroImage } = Astro.props;
const lang = Astro.locals.lang || 'en';
const t = getTranslation(lang);
---

<BaseLayout>
  <BaseHead title={title} description={description} />
  
  <article class="bg-primary">
    {heroImage && (
      <div class="w-full mb-8">
        <div class="px-8 2xl:max-w-7xl mx-auto">
          <div class="overflow-hidden rounded">
            <Image 
              width={1020} 
              height={510} 
              src={heroImage} 
              alt={title}
              class="w-full h-auto"
            />
          </div>
        </div>
      </div>
    )}
    
    <div class="px-8 2xl:max-w-4xl mx-auto py-12">
      <header class="mb-12">
        <div class="space-y-2 mb-6">
          <div class="h-0.5 bg-secondary"></div>
          <time class="text-sm text-secondary/70 block">
            {t.blog.publishedOn} {new Date(pubDate).toLocaleDateString(lang === 'zh' ? 'zh-CN' : 'en-US', {
              year: 'numeric',
              month: 'long',
              day: 'numeric'
            })}
          </time>
          {updatedDate && (
            <p class="text-xs text-secondary/60 italic">
              {t.blog.lastUpdated} {new Date(updatedDate).toLocaleDateString(lang === 'zh' ? 'zh-CN' : 'en-US', {
                year: 'numeric',
                month: 'long',
                day: 'numeric'
              })}
            </p>
          )}
        </div>
        <h1 class="text-secondary text-4xl lg:text-6xl font-bold mb-6">
          {title}
        </h1>
        {description && (
          <p class="text-lg text-secondary/80 mb-8">
            {description}
          </p>
        )}
        <div class="h-1.5 bg-secondary"></div>
      </header>
      
      <div class="prose prose-lg max-w-none text-secondary">
        <slot />
      </div>
    </div>
  </article>
</BaseLayout>
